{% set pathbrowse = currentPath %}
{% set multiselect = 1 %}
{% set multiselectFilesOnly = true %}

{% extends "flm::dialog-window.twig" %}
{% block heading %}
    <legend>{{ theUILang.fDiagSFVCreateSel }}</legend>
{% endblock %}

{% block scripts %}
    <script>
        (function (global) {
            var dialogs = flm.ui.getDialogs();
            var diagId = dialogs.getDialogId('window');
            var ext = 'sfv';

            dialogs.onStart(function () {

                return flm.manager.doSfvCreate(
                    dialogs.getTargetPath(diagId),
                    dialogs.getCheckedList(diagId)
                );
            });

            var file  = flm.ui.browser.getSelectedEntry();

            file = flm.getCurrentPath(flm.utils.stripFileExtension(file, [ext]));

            var fileName = file+ '.' + ext;

            dialogs.updateTargetPath(diagId, fileName);
        })
        (window);
    </script>
{% endblock %}

